/*!
 * KeyboardJS
 * 
 * Copyright 2011, Robert William Hurst
 * Licenced under the BSD License.
 * See https://raw.github.com/RobertWHurst/KeyboardJS/master/license.txt
 */
(function(e,t){typeof define=="function"&&define.amd?define(t):e.k=e.KeyboardJS=t()})(this,function(){function e(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,function(t){return n.call(e,t)})}function o(){var e=[];for(var t=s.length;t>-1;t-=1)if(s[t]){var n=s[t];for(var i=0;i<n.length;i+=1){var o=n[i],u=!0;for(var a=0;a<o.keys.length;a+=1){var f=o.keys[a];r.indexOf(f)<0&&(u=!1)}u&&e.push(o)}}return e}function u(e){if(r<1)return!0;var t=o(),n=[],s,u,a;for(var f=0;f<t.length;f+=1){var l=t[f],c=!1;for(a=0;a<l.keys.length;a+=1){u=l.keys[a];if(n.indexOf(u)>-1){c=!0;break}}if(!c){typeof l.callback=="function"&&(l.callback(e,l.keys,l.keyCombo)||(s=!1)),i[l.keyCombo]||(i[l.keyCombo]=l);for(a=0;a<l.keys.length;a+=1)u=l.keys[a],n.indexOf(u)<0&&n.push(u)}}return n.length?!1:s}function a(e){var t=o(),n;for(var r in i)if(i.hasOwnProperty(r)){var s=i[r],u=!1;for(var a=0;a<t.length;a+=1){var f=t[a].keyCombo;if(f===r){u=!0;break}}u||(typeof s.endCallback=="function"&&(s.endCallback(e,s.keys,s.keyCombo)||(n=!1)),delete i[r])}return n}function f(e,t,n){function r(){if(u&&u.length){var e=s[u.length];if(e.indexOf(a)>-1){var t=s[u.length].indexOf(a);s[u.length].splice(t,1)}}}var i=e.toLowerCase().replace(/\s/g,"").split(",");for(var o=0;o<i.length;o+=1){var u=i[o].split("+");if(u.length){s[u.length]||(s[u.length]=[]);var a={callback:t,endCallback:n,keyCombo:i[o],keys:u};s[u.length].push(a)}}return{clear:r}}function l(e,t,n,r,i){function s(){typeof u=="function"&&u(),typeof a=="function"&&a(),typeof l=="function"&&l(),typeof c=="function"&&c(),typeof h=="function"&&clearInterval(h)}var o=[0,0];if(typeof i!="function")return!1;var u=f(e,function(){o[0]===0&&(o[0]=-1)},function(){o[0]=0}).clear,a=f(t,function(){o[0]===0&&(o[0]=1)},function(){o[0]=0}).clear,l=f(n,function(){o[1]===0&&(o[1]=-1)},function(){o[1]=0}).clear,c=f(r,function(){o[1]===0&&(o[1]=1)},function(){o[1]=0}).clear,h=setInterval(function(){if(o[0]===0&&o[1]===0)return;i(o)},1);return{clear:s}}function c(e){if(e==="all"){s=[];return}e=e.replace(/\s/g,"").split(",");for(var t=s.length;t>-1;t-=1)if(s[t]){var n=s[t];for(var r=0;r<n.length;r+=1){var i=n[r],o=!1;for(var u=0;u<i.keys.length;u+=1){var a=i.keys[u];for(var f=0;f<e.length;f+=1){var l=e[f];if(l===a){o=!0;break}}if(o)break}o&&(s[t].splice(r,1),r-=1,s[t].length<1&&delete s[t])}}}function h(){return r}function p(e,n){t[e]=n}function d(e){t[e]&&(n=t[e])}[].indexOf||(Array.prototype.indexOf=function(e,t,n){for(n=this.length,t=(n+~~t)%n;t<n&&(!(t in this)||this[t]!==e);t++);return t^n?t:-1});var t={us:{backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,"break":19,capslock:20,escape:27,esc:27,space:32,spacebar:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,meta:91,command:91,windows:91,win:91,_91:92,select:93,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,multiply:106,add:107,subtract:109,decimal:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,num:144,scrolllock:145,scroll:145,semicolon:186,equal:187,equalsign:187,comma:188,dash:189,period:190,slash:191,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222}},n=t.us,r=[],i={},s=[];return e(document,"keydown",function(e){for(var t in n)n.hasOwnProperty(t)&&e.keyCode===n[t]&&r.indexOf(t)<0&&r.push(t);return u(e)}),e(document,"keyup",function(e){for(var t in n)if(n.hasOwnProperty(t)&&e.keyCode===n[t]){var i=r.indexOf(t);i>-1&&r.splice(i,1)}return a(e)}),e(window,"blur",function(e){return r=[],a(e)}),{bind:{key:f,axis:l},activeKeys:h,unbind:{key:c},locale:{add:p,set:d}}})